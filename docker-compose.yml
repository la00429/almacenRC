services:
  oracledb:
    build:
      context: . 
      dockerfile: Dockerfile
      args: 
        APP_USER: laura
        APP_USER_PWD: Laura2004
        ORACLE_PWD: oracle

    container_name: oracledb
    ports:
      - "1522:1521" 
      - "8080:8080" 
    environment:
      - ORACLE_PWD=${ORACLE_PWD:-oracle}
      - APP_USER=${APP_USER:-laura}
      - APP_USER_PWD=${APP_USER_PWD:-Laura2004}
      - ORACLE_DATABASE=XEPDB1
    volumes:
      - oracle_data:/opt/oracle/oradata
    healthcheck:
      test: ["CMD-SHELL", "sqlplus -s laura/Laura2004@localhost:1521/XEPDB1 <<< 'SELECT 1 FROM DUAL;' | grep -q '1' || exit 1"]
      interval: 30s
      timeout: 10s
      retries: 5
      start_period: 2m

volumes:
  oracle_data:
    driver: local